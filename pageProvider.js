(()=>{var ke=Object.create;var te=Object.defineProperty;var ze=Object.getOwnPropertyDescriptor;var Fe=Object.getOwnPropertyNames;var Je=Object.getPrototypeOf,Ue=Object.prototype.hasOwnProperty;var Ve=(e,t)=>()=>(e&&(t=e(e=0)),t);var v=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var De=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of Fe(t))!Ue.call(e,i)&&i!==r&&te(e,i,{get:()=>t[i],enumerable:!(n=ze(t,i))||n.enumerable});return e};var P=(e,t,r)=>(r=e!=null?ke(Je(e)):{},De(t||!e||!e.__esModule?te(r,"default",{value:e,enumerable:!0}):r,e));var c=Ve(()=>{});var ae=v((ft,oe)=>{c();oe.exports=R;R.default=R;R.stable=ie;R.stableStringify=ie;var A="[...]",re="[Circular]",y=[],_=[];function ne(){return{depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}}function R(e,t,r,n){typeof n>"u"&&(n=ne()),U(e,"",0,[],void 0,0,n);var i;try{_.length===0?i=JSON.stringify(e,t,r):i=JSON.stringify(e,se(t),r)}catch{return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;y.length!==0;){var s=y.pop();s.length===4?Object.defineProperty(s[0],s[1],s[3]):s[0][s[1]]=s[2]}}return i}function b(e,t,r,n){var i=Object.getOwnPropertyDescriptor(n,r);i.get!==void 0?i.configurable?(Object.defineProperty(n,r,{value:e}),y.push([n,r,t,i])):_.push([t,r,e]):(n[r]=e,y.push([n,r,t]))}function U(e,t,r,n,i,s,o){s+=1;var a;if(typeof e=="object"&&e!==null){for(a=0;a<n.length;a++)if(n[a]===e){b(re,e,t,i);return}if(typeof o.depthLimit<"u"&&s>o.depthLimit){b(A,e,t,i);return}if(typeof o.edgesLimit<"u"&&r+1>o.edgesLimit){b(A,e,t,i);return}if(n.push(e),Array.isArray(e))for(a=0;a<e.length;a++)U(e[a],a,a,n,e,s,o);else{var l=Object.keys(e);for(a=0;a<l.length;a++){var g=l[a];U(e[g],g,a,n,e,s,o)}}n.pop()}}function He(e,t){return e<t?-1:e>t?1:0}function ie(e,t,r,n){typeof n>"u"&&(n=ne());var i=V(e,"",0,[],void 0,0,n)||e,s;try{_.length===0?s=JSON.stringify(i,t,r):s=JSON.stringify(i,se(t),r)}catch{return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;y.length!==0;){var o=y.pop();o.length===4?Object.defineProperty(o[0],o[1],o[3]):o[0][o[1]]=o[2]}}return s}function V(e,t,r,n,i,s,o){s+=1;var a;if(typeof e=="object"&&e!==null){for(a=0;a<n.length;a++)if(n[a]===e){b(re,e,t,i);return}try{if(typeof e.toJSON=="function")return}catch{return}if(typeof o.depthLimit<"u"&&s>o.depthLimit){b(A,e,t,i);return}if(typeof o.edgesLimit<"u"&&r+1>o.edgesLimit){b(A,e,t,i);return}if(n.push(e),Array.isArray(e))for(a=0;a<e.length;a++)V(e[a],a,a,n,e,s,o);else{var l={},g=Object.keys(e).sort(He);for(a=0;a<g.length;a++){var E=g[a];V(e[E],E,a,n,e,s,o),l[E]=e[E]}if(typeof i<"u")y.push([i,t,e]),i[t]=l;else return l}n.pop()}}function se(e){return e=typeof e<"u"?e:function(t,r){return r},function(t,r){if(_.length>0)for(var n=0;n<_.length;n++){var i=_[n];if(i[1]===t&&i[0]===r){r=i[2],_.splice(n,1);break}}return e.call(this,t,r)}}});var M=v(C=>{"use strict";c();Object.defineProperty(C,"__esModule",{value:!0});C.EthereumProviderError=C.EthereumRpcError=void 0;var Ke=ae(),S=class extends Error{constructor(t,r,n){if(!Number.isInteger(t))throw new Error('"code" must be an integer.');if(!r||typeof r!="string")throw new Error('"message" must be a nonempty string.');super(r),this.code=t,n!==void 0&&(this.data=n)}serialize(){let t={code:this.code,message:this.message};return this.data!==void 0&&(t.data=this.data),this.stack&&(t.stack=this.stack),t}toString(){return Ke.default(this.serialize(),Ge,2)}};C.EthereumRpcError=S;var D=class extends S{constructor(t,r,n){if(!Be(t))throw new Error('"code" must be an integer such that: 1000 <= code <= 4999');super(t,r,n)}};C.EthereumProviderError=D;function Be(e){return Number.isInteger(e)&&e>=1e3&&e<=4999}function Ge(e,t){if(t!=="[Circular]")return t}});var j=v(w=>{"use strict";c();Object.defineProperty(w,"__esModule",{value:!0});w.errorValues=w.errorCodes=void 0;w.errorCodes={rpc:{invalidInput:-32e3,resourceNotFound:-32001,resourceUnavailable:-32002,transactionRejected:-32003,methodNotSupported:-32004,limitExceeded:-32005,parse:-32700,invalidRequest:-32600,methodNotFound:-32601,invalidParams:-32602,internal:-32603},provider:{userRejectedRequest:4001,unauthorized:4100,unsupportedMethod:4200,disconnected:4900,chainDisconnected:4901}};w.errorValues={"-32700":{standard:"JSON RPC 2.0",message:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."},"-32600":{standard:"JSON RPC 2.0",message:"The JSON sent is not a valid Request object."},"-32601":{standard:"JSON RPC 2.0",message:"The method does not exist / is not available."},"-32602":{standard:"JSON RPC 2.0",message:"Invalid method parameter(s)."},"-32603":{standard:"JSON RPC 2.0",message:"Internal JSON-RPC error."},"-32000":{standard:"EIP-1474",message:"Invalid input."},"-32001":{standard:"EIP-1474",message:"Resource not found."},"-32002":{standard:"EIP-1474",message:"Resource unavailable."},"-32003":{standard:"EIP-1474",message:"Transaction rejected."},"-32004":{standard:"EIP-1474",message:"Method not supported."},"-32005":{standard:"EIP-1474",message:"Request limit exceeded."},4001:{standard:"EIP-1193",message:"User rejected the request."},4100:{standard:"EIP-1193",message:"The requested account and/or method has not been authorized by the user."},4200:{standard:"EIP-1193",message:"The requested method is not supported by this Ethereum provider."},4900:{standard:"EIP-1193",message:"The provider is disconnected from all chains."},4901:{standard:"EIP-1193",message:"The provider is disconnected from the specified chain."}}});var B=v(m=>{"use strict";c();Object.defineProperty(m,"__esModule",{value:!0});m.serializeError=m.isValidCode=m.getMessageFromCode=m.JSON_RPC_SERVER_ERROR_MESSAGE=void 0;var x=j(),We=M(),ue=x.errorCodes.rpc.internal,Xe="Unspecified error message. This is a bug, please report it.",$e={code:ue,message:K(ue)};m.JSON_RPC_SERVER_ERROR_MESSAGE="Unspecified server error.";function K(e,t=Xe){if(Number.isInteger(e)){let r=e.toString();if(H(x.errorValues,r))return x.errorValues[r].message;if(fe(e))return m.JSON_RPC_SERVER_ERROR_MESSAGE}return t}m.getMessageFromCode=K;function de(e){if(!Number.isInteger(e))return!1;let t=e.toString();return!!(x.errorValues[t]||fe(e))}m.isValidCode=de;function Qe(e,{fallbackError:t=$e,shouldIncludeStack:r=!1}={}){var n,i;if(!t||!Number.isInteger(t.code)||typeof t.message!="string")throw new Error("Must provide fallback error with integer number code and string message.");if(e instanceof We.EthereumRpcError)return e.serialize();let s={};if(e&&typeof e=="object"&&!Array.isArray(e)&&H(e,"code")&&de(e.code)){let a=e;s.code=a.code,a.message&&typeof a.message=="string"?(s.message=a.message,H(a,"data")&&(s.data=a.data)):(s.message=K(s.code),s.data={originalError:ce(e)})}else{s.code=t.code;let a=(n=e)===null||n===void 0?void 0:n.message;s.message=a&&typeof a=="string"?a:t.message,s.data={originalError:ce(e)}}let o=(i=e)===null||i===void 0?void 0:i.stack;return r&&e&&o&&typeof o=="string"&&(s.stack=o),s}m.serializeError=Qe;function fe(e){return e>=-32099&&e<=-32e3}function ce(e){return e&&typeof e=="object"&&!Array.isArray(e)?Object.assign({},e):e}function H(e,t){return Object.prototype.hasOwnProperty.call(e,t)}});var pe=v(I=>{"use strict";c();Object.defineProperty(I,"__esModule",{value:!0});I.ethErrors=void 0;var G=M(),le=B(),d=j();I.ethErrors={rpc:{parse:e=>p(d.errorCodes.rpc.parse,e),invalidRequest:e=>p(d.errorCodes.rpc.invalidRequest,e),invalidParams:e=>p(d.errorCodes.rpc.invalidParams,e),methodNotFound:e=>p(d.errorCodes.rpc.methodNotFound,e),internal:e=>p(d.errorCodes.rpc.internal,e),server:e=>{if(!e||typeof e!="object"||Array.isArray(e))throw new Error("Ethereum RPC Server errors must provide single object argument.");let{code:t}=e;if(!Number.isInteger(t)||t>-32005||t<-32099)throw new Error('"code" must be an integer such that: -32099 <= code <= -32005');return p(t,e)},invalidInput:e=>p(d.errorCodes.rpc.invalidInput,e),resourceNotFound:e=>p(d.errorCodes.rpc.resourceNotFound,e),resourceUnavailable:e=>p(d.errorCodes.rpc.resourceUnavailable,e),transactionRejected:e=>p(d.errorCodes.rpc.transactionRejected,e),methodNotSupported:e=>p(d.errorCodes.rpc.methodNotSupported,e),limitExceeded:e=>p(d.errorCodes.rpc.limitExceeded,e)},provider:{userRejectedRequest:e=>O(d.errorCodes.provider.userRejectedRequest,e),unauthorized:e=>O(d.errorCodes.provider.unauthorized,e),unsupportedMethod:e=>O(d.errorCodes.provider.unsupportedMethod,e),disconnected:e=>O(d.errorCodes.provider.disconnected,e),chainDisconnected:e=>O(d.errorCodes.provider.chainDisconnected,e),custom:e=>{if(!e||typeof e!="object"||Array.isArray(e))throw new Error("Ethereum Provider custom errors must provide single object argument.");let{code:t,message:r,data:n}=e;if(!r||typeof r!="string")throw new Error('"message" must be a nonempty string');return new G.EthereumProviderError(t,r,n)}}};function p(e,t){let[r,n]=he(t);return new G.EthereumRpcError(e,r||le.getMessageFromCode(e),n)}function O(e,t){let[r,n]=he(t);return new G.EthereumProviderError(e,r||le.getMessageFromCode(e),n)}function he(e){if(e){if(typeof e=="string")return[e];if(typeof e=="object"&&!Array.isArray(e)){let{message:t,data:r}=e;if(t&&typeof t!="string")throw new Error("Must specify string message.");return[t||void 0,r]}}return[]}});var T=v(f=>{"use strict";c();Object.defineProperty(f,"__esModule",{value:!0});f.getMessageFromCode=f.serializeError=f.EthereumProviderError=f.EthereumRpcError=f.ethErrors=f.errorCodes=void 0;var me=M();Object.defineProperty(f,"EthereumRpcError",{enumerable:!0,get:function(){return me.EthereumRpcError}});Object.defineProperty(f,"EthereumProviderError",{enumerable:!0,get:function(){return me.EthereumProviderError}});var ge=B();Object.defineProperty(f,"serializeError",{enumerable:!0,get:function(){return ge.serializeError}});Object.defineProperty(f,"getMessageFromCode",{enumerable:!0,get:function(){return ge.getMessageFromCode}});var Ye=pe();Object.defineProperty(f,"ethErrors",{enumerable:!0,get:function(){return Ye.ethErrors}});var Ze=j();Object.defineProperty(f,"errorCodes",{enumerable:!0,get:function(){return Ze.errorCodes}})});var X=v((wt,W)=>{"use strict";c();var L=typeof Reflect=="object"?Reflect:null,ve=L&&typeof L.apply=="function"?L.apply:function(t,r,n){return Function.prototype.apply.call(t,r,n)},k;L&&typeof L.ownKeys=="function"?k=L.ownKeys:Object.getOwnPropertySymbols?k=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:k=function(t){return Object.getOwnPropertyNames(t)};function et(e){console&&console.warn&&console.warn(e)}var ye=Number.isNaN||function(t){return t!==t};function u(){u.init.call(this)}W.exports=u;W.exports.once=it;u.EventEmitter=u;u.prototype._events=void 0;u.prototype._eventsCount=0;u.prototype._maxListeners=void 0;var _e=10;function z(e){if(typeof e!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}Object.defineProperty(u,"defaultMaxListeners",{enumerable:!0,get:function(){return _e},set:function(e){if(typeof e!="number"||e<0||ye(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");_e=e}});u.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};u.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||ye(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function Ee(e){return e._maxListeners===void 0?u.defaultMaxListeners:e._maxListeners}u.prototype.getMaxListeners=function(){return Ee(this)};u.prototype.emit=function(t){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var i=t==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var o;if(r.length>0&&(o=r[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var l=s[t];if(l===void 0)return!1;if(typeof l=="function")ve(l,this,r);else for(var g=l.length,E=Pe(l,g),n=0;n<g;++n)ve(E[n],this,r);return!0};function be(e,t,r,n){var i,s,o;if(z(r),s=e._events,s===void 0?(s=e._events=Object.create(null),e._eventsCount=0):(s.newListener!==void 0&&(e.emit("newListener",t,r.listener?r.listener:r),s=e._events),o=s[t]),o===void 0)o=s[t]=r,++e._eventsCount;else if(typeof o=="function"?o=s[t]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),i=Ee(e),i>0&&o.length>i&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=e,a.type=t,a.count=o.length,et(a)}return e}u.prototype.addListener=function(t,r){return be(this,t,r,!1)};u.prototype.on=u.prototype.addListener;u.prototype.prependListener=function(t,r){return be(this,t,r,!0)};function tt(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Ce(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=tt.bind(n);return i.listener=r,n.wrapFn=i,i}u.prototype.once=function(t,r){return z(r),this.on(t,Ce(this,t,r)),this};u.prototype.prependOnceListener=function(t,r){return z(r),this.prependListener(t,Ce(this,t,r)),this};u.prototype.removeListener=function(t,r){var n,i,s,o,a;if(z(r),i=this._events,i===void 0)return this;if(n=i[t],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,n.listener||r));else if(typeof n!="function"){for(s=-1,o=n.length-1;o>=0;o--)if(n[o]===r||n[o].listener===r){a=n[o].listener,s=o;break}if(s<0)return this;s===0?n.shift():rt(n,s),n.length===1&&(i[t]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",t,a||r)}return this};u.prototype.off=u.prototype.removeListener;u.prototype.removeAllListeners=function(t){var r,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[t]),this;if(arguments.length===0){var s=Object.keys(n),o;for(i=0;i<s.length;++i)o=s[i],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[t],typeof r=="function")this.removeListener(t,r);else if(r!==void 0)for(i=r.length-1;i>=0;i--)this.removeListener(t,r[i]);return this};function we(e,t,r){var n=e._events;if(n===void 0)return[];var i=n[t];return i===void 0?[]:typeof i=="function"?r?[i.listener||i]:[i]:r?nt(i):Pe(i,i.length)}u.prototype.listeners=function(t){return we(this,t,!0)};u.prototype.rawListeners=function(t){return we(this,t,!1)};u.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):Le.call(e,t)};u.prototype.listenerCount=Le;function Le(e){var t=this._events;if(t!==void 0){var r=t[e];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}u.prototype.eventNames=function(){return this._eventsCount>0?k(this._events):[]};function Pe(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function rt(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function nt(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}function it(e,t){return new Promise(function(r,n){function i(o){e.removeListener(t,s),n(o)}function s(){typeof e.removeListener=="function"&&e.removeListener("error",i),r([].slice.call(arguments))}Re(e,t,s,{once:!0}),t!=="error"&&st(e,i,{once:!0})})}function st(e,t,r){typeof e.on=="function"&&Re(e,"error",t,r)}function Re(e,t,r,n){if(typeof e.on=="function")n.once?e.once(t,r):e.on(t,r);else if(typeof e.addEventListener=="function")e.addEventListener(t,function i(s){n.once&&e.removeEventListener(t,i),r(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e)}});c();var q=P(T()),Ie=P(X());c();c();var $=P(T()),Oe=P(X()),Q=class extends Oe.default{_requestIdPool=[...Array(500).keys()];_EVENT_PRE="EXTENSION_WALLET_";listenCallback;_waitingMap=new Map;request(t){if(!this._requestIdPool.length)throw $.ethErrors.rpc.limitExceeded();let r=this._requestIdPool.shift();return new Promise((n,i)=>{this._waitingMap.set(r,{data:t,resolve:n,reject:i}),this.send("request",{ident:r,data:t})})}onResponse=async({ident:t,res:r,err:n}={})=>{if(!this._waitingMap.has(t))return;let{resolve:i,reject:s}=this._waitingMap.get(t);this._requestIdPool.push(t),this._waitingMap.delete(t),n?s(n):i(r)};onRequest=async({ident:t,data:r})=>{if(this.listenCallback){let n,i;try{n=await this.listenCallback(r)}catch(s){i={message:s.message,stack:s.stack},s.code&&(i.code=s.code),s.data&&(i.data=s.data)}this.send("response",{ident:t,res:n,err:i})}};_dispose=()=>{for(let t of this._waitingMap.values())t.reject($.ethErrors.provider.userRejectedRequest());this._waitingMap.clear()}},Ne=Q;var N=class extends Ne{_channel;constructor(t){if(super(),!t)throw new Error("the broadcastChannel name is missing");this._channel=new BroadcastChannel(t)}connect=()=>(this._channel.onmessage=({data:{type:t,data:r}})=>{t==="message"?this.emit("message",r):t==="response"&&this.onResponse(r)},this);listen=t=>(this.listenCallback=t,this._channel.onmessage=({data:{type:r,data:n}})=>{r==="request"&&this.onRequest(n)},this);send=(t,r)=>{this._channel.postMessage({type:t,data:r})};dispose=()=>{this._dispose(),this._channel.close()}};c();var qe=P(T()),Y=class{provider;constructor(t){this.provider=t}_emit(t,r){this.provider._initialized&&this.provider.emit(t,r)}connect=t=>{this.provider._isConnected||(this.provider._isConnected=!0,this.provider._state.isConnected=!0,this._emit("connect",t))};unlock=()=>{this.provider._isUnlocked=!0,this.provider._state.isUnlocked=!0};lock=()=>{this.provider._isUnlocked=!1};disconnect=()=>{this.provider._isConnected=!1,this.provider._state.isConnected=!1,this.provider._state.accounts=null,this.provider._selectedAddress=null;let t=qe.ethErrors.provider.disconnected();this._emit("accountsChanged",[]),this._emit("disconnect",t),this._emit("close",t)};accountsChanged=t=>{t?.[0]!==this.provider._selectedAddress&&(this.provider._selectedAddress=t?.[0],this.provider._state.accounts=t,this._emit("accountsChanged",t))};networkChanged=({network:t})=>{this.connect({}),t!==this.provider._network&&(this.provider._network=t,this._emit("networkChanged",t))}},Ae=Y;c();var Z=class{_allCheck=[];_tasks=[];constructor(t){this._allCheck=[...Array(t)]}check=t=>{this._allCheck[t-1]=!0,this._proceed()};uncheck=t=>{this._allCheck[t-1]=!1};_proceed=()=>{if(!this._allCheck.some(t=>!t))for(;this._tasks.length;){let{resolve:t,fn:r}=this._tasks.shift();t(r())}};call=t=>new Promise(r=>{this._tasks.push({fn:t,resolve:r}),this._proceed()})},Se=Z;c();var Me=0,je=e=>{if(Me++,!(Me>600)){if(document.readyState==="complete")return e(),!0;setTimeout(()=>{je(e)},100)}},xe=e=>{je(e)},F=document.querySelector.bind(document);var J=(e,...t)=>{},ot=document.currentScript,at=ot?.getAttribute("channel")||"TIDEWALLET",ee=class extends Ie.EventEmitter{_selectedAddress=null;_network=null;_isConnected=!1;_initialized=!1;_isUnlocked=!1;_state={accounts:null,isConnected:!1,isUnlocked:!1,initialized:!1,isPermanentlyDisconnected:!1};_pushEventHandlers;_requestPromise=new Se(0);_bcm=new N(at);constructor({maxListeners:t=100}={}){super(),this.setMaxListeners(t),this.initialize(),this._pushEventHandlers=new Ae(this)}initialize=async()=>{document.addEventListener("visibilitychange",this._requestPromiseCheckVisibility),this._bcm.connect().on("message",this._handleBackgroundMessage),xe(()=>{let t=window.top?.location.origin,r=F('head > link[rel~="icon"]')?.href||F('head > meta[itemprop="image"]')?.content,n=document.title||F('head > meta[name="title"]')?.content||t;this._bcm.request({method:"tabCheckin",params:{icon:r,name:n,origin:t}})});try{let{network:t,accounts:r,isUnlocked:n}=await this._request({method:"getProviderState"});n&&(this._isUnlocked=!0,this._state.isUnlocked=!0),this.emit("connect",{}),this._pushEventHandlers.networkChanged({network:t}),this._pushEventHandlers.accountsChanged(r)}catch{}finally{this._initialized=!0,this._state.initialized=!0,this.emit("_initialized")}this.keepAlive()};keepAlive=async()=>(await this._request({method:"keepAlive",params:{}}),setTimeout(()=>{this.keepAlive()},1e3));_requestPromiseCheckVisibility=()=>{document.visibilityState==="visible"?this._requestPromise.check(1):this._requestPromise.uncheck(1)};_handleBackgroundMessage=({event:t,data:r})=>{if(J("[push event]",t,r),this._pushEventHandlers[t])return this._pushEventHandlers[t](r);this.emit(t,r)};_request=async t=>{if(!t)throw q.ethErrors.rpc.invalidRequest();return this._requestPromiseCheckVisibility(),this._requestPromise.call(()=>(J("[request]",JSON.stringify(t,null,2)),this._bcm.request(t).then(r=>(J("[request: success]",t.method,r),r)).catch(r=>{throw J("[request: error]",t.method,(0,q.serializeError)(r)),(0,q.serializeError)(r)})))};connect=async()=>this._request({method:"connect"});getBalance=async()=>this._request({method:"getBalance"});getAccountName=async()=>this._request({method:"getAccountName"});isConnected=async()=>this._request({method:"isConnected"});getAccount=async()=>this._request({method:"getAccount"});getPublicKey=async()=>this._request({method:"getPublicKey"});createTx=async t=>this._request({method:"createTx",params:{...t}});signMessage=async t=>this._request({method:"signMessage",params:{text:t}});signTx=async t=>this._request({method:"signTx",params:{hex:t}})},Te=new ee;window.tidecoin||(window.tidecoin=new Proxy(Te,{deleteProperty:()=>!0}));Object.defineProperty(window,"tidecoin",{value:new Proxy(Te,{deleteProperty:()=>!0}),writable:!1});window.dispatchEvent(new Event("tidecoin#initialized"));})();
